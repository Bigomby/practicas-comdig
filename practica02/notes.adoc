= Teoría

== Funciones y scripts

Ambos son ficheros con extensión `.m`. Sin embargo:

* **Funciones:** La primera línea debe contener la sentencia:
+
[source,matlab]
----
function salida = mifuncion(entrada)
----
* **Scripts**: Las variables de un scripts son válidas dentro de todo el script.

NOTE: Las variables de la función son locales a la función.


== Histograma

Es una aproximación de una función densidad de probablilidad.

=== Ejemplo: Dibujar histograma

Vamos a dibujar el histogrma de una gausiana:

Para generar la gausiana: `sqrt(var) * rand(1, <n. de elementos>) + media`

[.text-center, width=75%]
image::https://i.imgur.com/ZDnKCNJ.png[]


[source,matlab]
----
% Generamos la gausiana
x=randn(1, 1000)

% Calculamos el histograma con 100 muestras
[hi, ci]=hist(x, 100);

% Longitud de x
Np = length(x);

% Calculamos la función densidad de probabilidad
fxi = hi/Np/(ci(2), ci(1))
----

== Función densidad de probabilidad

[source,matlab]
----
%% LCDfdp: Calcula la fdp de una Waa de forma empírica
function [fxi,ci] = LCDfdp(x)

  % Calculamos el histograma con 100 muestras
  [hi, ci]=hist(x, 100);

  % Longitud de x
  Np = length(x);

  % Calculamos la función densidad de probabilidad
  fxi = hi/Np/(ci(2) - ci(1));
----

= Ejercicios

== Apartado 1

++++
<p>
Generar

<math>
  <mrow><mi>N</mi><mi>p</mi><mo>=</mo><msup><mrow><mn>10</mn></mrow><mrow><mn>6</mn></mrow></msup></mrow>
</math>

muestras de dos variables aleatorias gaussianas

<math>
<mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math>

y 

<math>
<mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>

, conjuntamente gaussianas, con medias respectivamente +1 y −1 y varianza 

<math>a
<mrow><msup><mrow><mi>&#963;</mi></mrow><mrow><mn>2</mn></mrow></msup><mo>=</mo><mn>4</mn></mrow></math>

. Obtener y representar en una misma figura sus funciones densidad de probabilidad.
</p>
++++

=== Solución


[.text-center, width=75%]
image::https://i.imgur.com/QpjURlL.png[]

[source,matlab]
----
Np = 1e6;
N1 = sqrt(4) * randn(1,Np) + 1;
N2 = sqrt(4) * randn(1,Np) - 1;

[f1, c1] = LCDfdp(N1);
plot(c1,f1);
----

== Apartado 2

Se define una nueva variable aleatoria gaussiana (¿por qué es gaussiana?) X en la forma: 

++++
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow><mi>X</mi><mo>=</mo><mi>N</mi><mn>1</mn><mo>+</mo><mi>N</mi><mn>2</mn></mrow></math>

++++

Encontrar teórica y experimentalmente su media, varianza y función densidad de  probabilidad. Representando las dos funciones teóricas y experimental en un mismo gráfico, comprobar su coincidencia.

NOTE: El teorema central del límite nos dice que la suma de muchas variables aletorias de distinta naturaleza convergen a una variable aleatoria gaussiana.

[cols="a,a,a", options="header"]
|====
^| Parámetro
^| Forma teórica
^| Forma experimental

|++++
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow><mi>&#956;</mi></mrow></math>
++++

|++++
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow><mn>0</mn></mrow></math>
++++

|++++
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow><mi>m</mi><mi>e</mi><mo>=</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></math>
++++

////

|++++
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow><msup><mrow><mi>&#963;</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math>
++++

|++++
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow><mn>8</mn></mrow></math>
++++

|++++
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow><mi>v</mi><mi>e</mi><mo>=</mo><mi>v</mi><mi>a</mi><mi>r</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></math>
++++
|====

Calculamos `fdp` de forma experimental:

[source,matlab]
----
fx,cx = LCDfdp(x);
plot(x,fx);
----

[.text-center, width=75%]
image::https://i.imgur.com/NETBoCf.png[]

== Apartado 3

++++
<p>
Sea ahora una nueva variable aleatoria X definida en la forma:

<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi>X</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>N</mi></mrow></math>

siendo A una variable aleatoria discreta que toma con probabilidades {1/4, 3/4} los valores +1, -1, respectivamente. N es una variable aleatoria gaussiana de media 0 y varianza

<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><msup><mrow><mi>&#963;</mi></mrow><mrow><mn>2</mn></mrow></msup><mo>=</mo><mn>0</mn><mi>.</mi><mn>1</mn></mrow></math>. 
</p>
++++

Encontrar teórica y experimentalmente las funciones densidad de probabilidad de las siguientes variables aleatorias:

++++
<math display="block">
<mrow><msub><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>&#8801;</mo><mi>X</mi><mi>|</mi><mi>A</mi><mo>=</mo><mo>+</mo><mn>1</mn></mrow>
</math>
++++

++++
<math display="block">
<mrow><msub><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>&#8801;</mo><mi>X</mi><mi>|</mi><mi>A</mi><mo>=</mo><mo>-</mo><mn>1</mn></mrow>
</math>
++++

++++
<math display="block">
<mi>X</mi>
</math>
++++

[NOTE]
====
Para generar la función A, que es una variable aleatoria discreta, usamos:

[source,matlab]
----
A = sign(rand(1,Np) - 0.75)
----
====


=== Solución

[.text-center, width=75%]
image::https://i.imgur.com/Q13GXxf.png[]

[cols="a,a,a", options="header"]
|====
| Parámetro
| Forma Teórica
| Forma experimental

| 
++++
<math display="block">
<mrow><msub><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow>
</math>
++++
| Rango, evaluar, plot
| `LCDfdp(); plot();`

| 
++++
<math display="block">
<mrow><msub><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow>
</math>
++++
| Rango, evaluar, plot
| `LCDfdp(); plot();`

|
++++
<math display="block">
<mi>X</mi>
</math>
++++
| Rango, evaluar, plot
| `ve = var(x);`
|====
